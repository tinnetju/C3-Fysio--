<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <table class="table">
	<thead>
	<tr>
            <th class="col-md-1">CopyID</th>
            <th class="col-md-3">Status</th>
            <th class="col-md-4">Lener</th>
            <th class="col-md-4"></th>
	</tr>
	</thead>
	<tbody>
	<tr th:if="${copies.empty}">
		<td colspan="4">Geen exemplaren beschikbaar</td>
	</tr>
	<tr th:each="copy : ${copies}">
		<td th:text="${copy.CopyID}">1</td>
		<!-- Als LoanDate bestaat en ReturnedDate is null, dan is het boek uitgeleend. -->
		<td th:text="*{copy.Available == 0}? 'Uitgeleend op ' + ${copy.LoanDate} : 'Beschikbaar'">1</td>
		<td><a th:if="${copy.Available == 0}" th:href="@{/member/{id}(id=${copy.MemberID})}" th:text="*{copy.FirstName}? *{copy.FirstName} + ' ' + *{copy.LastName} : ''">1</a></td>
		<td>
			<!--
				Formulier om een boek te lenen, als het beschikbaar is.
				Het Loan object dat we hier gebruiken en invullen is afkomstig uit de Controller.
				Bij aanroep van deze template view moeten we dus een Loan object
				in het model meegeven.
				-->
			<form th:if="${copy.Available == 1}" th:action="@{/loan/create}" th:object="${loan}" method="post" class="form-horizontal">
				<!-- Hier zetten we de CopyID en EAN/ISBN van het boek in het formulier. Nodig voor het maken van een Loan.
					Dit zijn de precieze attributen zoals ze ook in de class zitten. Je kunt ook de getters/setters gebruiken.-->
				<input type="hidden" name="copyID" th:value="${copy.CopyID}" />
				<input type="hidden" name="bookISBN" th:value="${book.EAN}" />
				<div class="form-group">
					<!-- Deze selectbox zet de MemberID waarde in het exception object. Na verzenden van het
						 formulier via de knop wordt het exception object meegestuurd naar de controller die de
						 action van dit formulier afhandelt.

						 Deze selectbox maakt gebruik van bootstrap-select. Zie de included css en js.
						 Zie ook https://silviomoreto.github.io/bootstrap-select
						 -->
					<select th:field="${loan.MemberID}" id="tagList" class="selectpicker  show-tick show-menu-arrow" name="selectId"
							th:attr="disabled=${copy.LoanDate != null and copy.ReturnedDate == null ? 'disabled' : null}">
						<option th:each="member : ${members}"
								th:value="${member.MemberID}"
								th:text="${member.FullName}"
						/>
					</select>
					<button type="submit" class="btn pull-right" name="save"
							th:attr="disabled=${copy.LoanDate != null and copy.ReturnedDate == null ? 'disabled' : null}"
							th:classappend="${copy.LoanDate != null and copy.ReturnedDate == null} ? 'btn-secondary disabled' : 'btn-success'">
						<i class="glyphicon glyphicon-ok"></i>Lenen
					</button>
				</div>
			</form>
		</td>
	</tr>
	</tbody>
</table>
    </body>
</html>
